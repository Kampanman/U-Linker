# [【exises-15】停止アカウント・ユーザー登録データ削除テーブル]

- 【exises-15】機能説明
  - 特徴・機能
    - 停止されているアカウントの情報を反映し、削除するアカウントを選択できる
    - マスター権限を有する（loginUser.isMaster が 1 である）ユーザーのみが表示することができる
    - エリア表示時にサーバー側 API にリクエストを送信することで、アカウント情報を取得する
    - サーバー側 API に送信するオブジェクト変数「param」には、次の内容を格納する
      - 『type: "getStoppedAccounts"』
      - 『is_master: loginUser.isMaster』
      - 『master_id: loginUser.ownerId』
      - 『token: {ランダムな半角英数字 16 文字}』
  - 関連変数
    - loginUser.isMaster（int 型。マスター権限保有者は 1）
    - loginUser.ownerId（String 型）
- 【exises-15-01】停止中アカウント一覧テーブル
  - 特徴・機能
    - 停止中のアカウントのユーザー情報と、そのユーザーが登録してきた[ulinker_notes]と[ulinker_videos]のレコード件数を反映したテーブル
  - 関連変数
    - stoppedAccountInfo（Object の List 型）
      - 以下では各レコードのオブジェクトを「account_row」と呼称する
  - 【exises-15-01-01】チェックボックス
    - 特徴・機能
      - 削除対象アカウントを選択できるチェックボックス
      - 内部データ「data-owner-id」には、account_row.ownerId の値を格納する
      - ここで選択したアカウント、及びその登録データが、アカウント・登録データを削除ボタン押下以降の処理での削除対象となる
      - [ulinker_accounts]から取得した、停止中のアカウントの「owner_id」の値を格納している
      - チェックされたレコードの account_row.ownerId は、変数「deleteAccountIds」に格納される
    - 関連変数
      - account_row.ownerId（String 型）
      - account_row.isChecked（boolean 型）
      - deleteAccountIds（String の List 型）
  - 【exises-15-01-02】ユーザー名
    - 特徴・機能
      - 削除対象アカウントのユーザー名を反映する
    - 関連変数
      - account_row.name
  - 【exises-15-01-03】ノート登録数
    - 特徴・機能
      - 削除対象アカウントのユーザーが登録した[ulinker_notes]のレコード数を反映する
    - 関連変数
      - account_row.noteAmounts
  - 【exises-15-01-04】ビデオ登録数
    - 特徴・機能
      - 削除対象アカウントのユーザーが登録した[ulinker_videos]のレコード数を反映する
    - 関連変数
      - account_row.videoAmounts
- 【exises-15-02】アカウント・登録データを削除ボタン
  - 特徴・機能
    - アカウント・登録データ削除確認モーダル(1)を表示する。
      - タイトル：『アカウント・データ削除確認』
      - テキスト：『あなたは本サービスのユーザー{「{account_row.name}」}（← 選択されたユーザーごとにカンマ区切りで表示）のアカウントを削除しようとしています。』
      - 表示ボタン：「確認」をテキスト下に配置。このモーダルでは「閉じる」や「×」は配置しない
    - アカウント・登録データ削除確認モーダル(1)で「確認」を押下後、アカウント・登録データ削除確認モーダル(2)を表示する。
      - タイトル：『アカウント・データ削除確認！』
      - テキスト：『安全のため、あなたのログイン ID を入力してください。』
      - 入力欄：「ログイン ID を入力」を placeholder に持つ入力欄
      - 表示ボタン：
        - 「入力したぞ」を入力欄下に配置
          - 入力欄に値が入力されていない場合は非活性
        - 「やっぱやめとく」を入力欄下、「入力したぞ」の右に配置
          - 以下、モーダル内の「やっぱやめとく」は、モーダルを閉じる機能を有することで共通とする。
      - 表示バリデーションメッセージ
        - 「あァ！？アんだってぇ！？」
          - 初期状態は非表示
          - 入力された内容が loginUser.ownerId の値と合致していない状態で「入力したぞ」を押下した場合に表示
          - 押下すると非表示になる
    - アカウント・登録データ削除確認モーダル(2)で「入力したぞ」を押下後、アカウント・登録データ削除確認モーダル(3)を表示する。
      - タイトル：『アカウント・データ削除確認！！』
      - テキスト：
        - 『ついでにあなたが人間（ホモ・サピエンス）であることを証明してください。』
        - 『以下の文字を入力してください。』
        - {ランダムな半角英数字 16 桁}
      - 入力欄：「表示されている文字を入力」を placeholder に持つ入力欄
      - 表示ボタン：
        - 「入力したぞ（怒）」を入力欄下に配置
          - 入力欄に値が入力されていない場合は非活性
        - 「やっぱやめとく」を入力欄下、「入力したぞ（怒）」の右に配置
      - 表示バリデーションメッセージ
        - 「あァ！？アんだってぇ！？」
          - 初期状態は非表示
          - 入力された内容が、{ランダムな半角英数字 16 桁}の値と合致していない状態で「入力したぞ（怒）」を押下した場合に表示
          - 押下すると非表示になる
    - アカウント・登録データ削除確認モーダル(3)で「入力したぞ（怒）」を押下後、アカウント・登録データ削除確認モーダル(4)を表示する。
      - タイトル：『アカウント・データ削除確認（最終）』
      - テキスト：
        - 『いいでしょう。削除を実行しますが、後悔しませんね！？』
      - 表示ボタン：
        - 「いいからやれ（怒）」を入力欄下に配置
        - 「やっぱやめとく」を入力欄下、「いいからやれ（怒）」の右に配置
      - 表示バリデーションメッセージ
        - 「あァ！？アんだってぇ！？」
          - 初期状態は非表示
          - 入力された内容が、{ランダムな半角英数字 16 桁}の値と合致していない状態で「入力したぞ（怒）」を押下した場合に表示
          - 押下すると非表示になる
    - アカウント・登録データ削除確認モーダル(4)で「いいからやれ（怒）」を押下後、削除のための API 通信が実行される
      - サーバー側 API に送信するオブジェクト変数「param」には、次の内容を格納する
        - 『type: "deleteAccounts"』
        - 『is_master: loginUser.isMaster』
        - 『master_id: loginUser.ownerId』
        - 『delete_owner_ids: deleteAccountIds』
        - 『token: {ランダムな半角英数字 16 文字}』
      - 非同期通信後はレスポンスが返却されるので、結果のメッセージをアカウント・登録データ削除完了モーダルに表示する
        - 削除処理に失敗した場合はそのメッセージを表示する
        - 削除処理に成功した場合は、完了した旨のメッセージを表示する
      - 削除処理に成功した場合、3 秒後にブラウザがリロードされる
- 【exises-15-03】リセットボタン
  - 特徴・機能
    - チェックボックスのチェックを付けた分を一括解除する
    - account_row.isChecked をすべて false にする
  - 関連変数
    - account_row.isChecked
