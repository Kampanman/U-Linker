# [【resetPass】パスワード再設定フォーム]

- 【resetpass】機能説明
  - 特徴・機能
    - パスワード再設定ページ遷移用のメールを受信したユーザーが、このフォームでパスワードの再設定を行う
    - 対象ユーザーの[ulinker_accounts]における「token」の値が、URL 内の token が入る部分と合致している場合に表示される
      - そうでない場合は、フォーム上にエラーメッセージを表示する
  - 関連機能
    - [【nonses-03】パスワードリセットメール送信フォーム]
  - 関連変数
    - resetPassInfo（Object 型）
- 【resetpass-01】ヘッダー
  - 特徴・機能
    - 本サービス「U-Linker」のブラウザページヘッダー
    - パスワード再設定フォームの場合は、タイトルロゴのみ表示する
  - 関連変数
    - なし
  - 【resetpass-01-01】タイトルロゴ
    - 特徴・機能
      - 本サービス「U-Linker」のタイトルロゴ
      - 当ページでは押下しても何も変化は起きない
- 【resetpass-02】パスワード再設定フォーム
  - 特徴・機能
    - ユーザーが再設定するパスワードを入力するフォーム
    - 次の場合は、対応するエラーメッセージを中央に表示
      - 対象ユーザーの[ulinker_accounts]における「token」の値が、URL 内に含まれていない場合
        - 『パスワード再設定可能なアカウントではないようです。』
      - 画面操作時の時刻が対象ユーザーの[ulinker_accounts]における「token_limit」の値を超過している場合
        - 『受信されているメールの URL からのパスワード再設定が可能な時刻を超過しているようです。』
        - ページが表示された5秒後に、トップページ（pages/index.php）にリダイレクトする。
  - 関連変数
    - resetPassInfo.token（String 型）
  - 【resetpass-02-01】パスワード入力欄(1)
    - 特徴・機能
      - 再設定したいパスワードを入力できる
      - 「パスワード（半角英数字 8 文字以上 16 文字以内）」のラベルを入力欄に設定する
      - 長さは半角英数字 8 文字以上 16 字以内
      - 入力必須の項目
    - 関連変数
      - resetPassInfo.password1（String 型）
  - 【resetpass-02-02】パスワード入力欄(2)
    - 特徴・機能
      - 再設定したいパスワードを入力できる
      - 「パスワード（半角英数字 8 文字以上 16 文字以内）」のラベルを入力欄に設定する
      - パスワード入力欄(1)の入力内容と合致している必要がある
      - 入力必須の項目
    - 関連変数
      - resetPassInfo.password2（String 型）
  - 【resetpass-02-03】登録ボタン
    - 特徴・機能
      - 初期状態は非活性
        - パスワード入力欄が 2 つとも入力済みの状態になると活性化する
      - バリデーションを実施した上で、入力内容を API に送り、レスポンスを受け取る
        - バリデーションでは以下の判定を行う
          - パスワード(1)が半角英数字 8 文字以上 16 文字以内の形式ではない
          - パスワード(1)とパスワード(2)が合致していない
      - パスワード再設定確認モーダルを表示する。以下はこのモーダルで「はい」を選択した場合
        - パスワードのための非同期通信が実行される
        - 非同期通信後はレスポンスが返却されるので、結果のメッセージをパスワード再設定完了モーダルに表示する
          - 再設定処理に失敗した場合はそのメッセージを表示する
          - 再設定処理に成功した場合は、完了した旨のメッセージを表示する
        - 再設定処理に成功した場合、3 秒後にブラウザがリロードされる
        - サーバー側 API に送信するオブジェクト変数「param」には、次の内容を格納する
          - 『type: "resetPass"』
          - 『password: resetPassInfo.password1』
          - 『accountToken: resetPassInfo.token』
          - 『token: {ランダムな半角英数字 16 文字}』
      - 関連変数
        - resetPassInfo（Object 型）
        - isResetPassConfirmOpen（boolean 型。初期状態は false）
        - isResetPassCompleteOpen（boolean 型。初期状態は false）
